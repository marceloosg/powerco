---
title: "Power Co Exploratory Analysis"
output: html_notebook
---

#Libraries
```{r}
library(data.table)
library(RANN)
```



#Load Data
```{r}
data=fread('train/ml_case_training_data.csv')
output=fread('train/ml_case_training_output.csv')
hist=fread('train/ml_case_training_hist_data.csv')
summary(data)
```


```{r,cache=TRUE}
model=train_preprocess_model(data)


```
```{r,cache=TRUE}
processed_train_data=predict_preprocess_model(model,data)

```

```{r}
structure_data =build_binaries(structure_data)
dim(structure_data$combined$binaries)
```

#Dimension Reduction
## Although homols package is more appropriate for binary variables, we will testing it due to speed constraints
```{r}
model=train_binary_pca(model,structure_data)
fviz_screeplot(model$pca$binary, addlabels = TRUE)
```
```{r}
ggplot(data.table(dim=1:15,exp_var=(cumsum(model$pca$binary$sdev^2)/sum(model$pca$binary$sdev^2))[1:15]))+geom_bar(aes(x=dim,y=exp_var),stat="identity",fill="blue")+ylim(0,1)+geom_hline(yintercept=0.9,color="red")
```

# Let's see how accurate pca can reconstruct the binary matrix with just 15 dimensions
```{r}
aplot=pca_accuracy(model,structure_data)
aplot
```

# Are the low accuracy columns those correlated?
```{r}
corrplot::corrplot(cor(structure_data$combined$binaries[,model$pca$bin_accuracy[accurate==F]$names,with=F]))
```
```{r}
model=train_continuous_pca(model,structure_data)
```


